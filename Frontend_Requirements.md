# フロントエンド要件定義書

本ドキュメントは、個人ウェブサイトプロジェクトのフロントエンドシステムの要件を定義する。

## 1. システム構成における役割

フロントエンドは、ユーザーが直接操作するUI（ユーザーインターフェース）を提供する責務を持つ。Reactを用いたSPA（シングルページアプリケーション）として構築されており、バックエンドAPIと通信して動的なコンテンツ表示やデータ操作を行う。

プロジェクトはpnpmによるモノレポ構成であり、本アプリケーションは `frontend/apps/public` に配置されている。

## 2. 現行の実装から抽出した主要機能

### 2.1. ページ構成

`react-router-dom` を利用して、以下の主要ページへのルーティングを管理している。

-   **/ (Home):** トップページ。
-   **/profile:** プロフィールページ。
-   **/projects:** プロジェクト一覧ページ。
-   **/research:** 研究内容ページ。
-   **/contact:** 問い合わせページ。
-   **/admin:** サイト管理者がコンテンツを管理するためのダッシュボード。

### 2.2. データ表示・操作

-   バックエンドAPIから取得したデータを各ページに表示する。
-   `Admin`ページでは、サイトコンテンツ（プロフィール、技術スタック、SNSリンク等）を更新するためのUIを提供する。
-   `@dnd-kit`ライブラリを利用したドラッグ＆ドロップによるUI操作機能を持つ（管理画面での項目並べ替え等）。

### 2.3. 多言語対応

-   `i18next` および `react-i18next` を導入しており、日本語・英語等の多言語切り替え機能が実装されている。

### 2.4. 状態管理とAPI通信

-   `lib/useApiResource.ts` というカスタムフックが存在し、API通信とそれに伴う状態（ローディング、エラー、データ）を一元的に管理していると推測される。
-   `hooks/useAdminSession.ts` で管理者セッションの有無を管理し、認証が必要なページへのアクセス制御を行っている。

## 3. 外部依存関係

### 3.1. ビルド・実行環境

-   Node.js
-   pnpm (パッケージマネージャ)
-   Vite (ビルドツール、開発サーバー)

### 3.2. フレームワーク・主要ライブラリ

| 役割               | ライブラリ名                               |
| :----------------- | :----------------------------------------- |
| UIフレームワーク   | `react`, `react-dom`                       |
| ルーティング       | `react-router-dom`                         |
| スタイリング       | `tailwindcss`                              |
| ドラッグ＆ドロップ | `@dnd-kit/core`, `@dnd-kit/sortable`       |
| 多言語対応         | `i18next`, `react-i18next`                 |
| テスティング       | `vitest`, `@testing-library/react`, `msw`  |
| Lint/Format      | `eslint`, `prettier`                       |
| 内部パッケージ     | `@personal-website/shared` (workspace:*)  |

## 4. データ構造・型定義

-   バックエンドAPIから取得するデータモデルの型定義が、`@personal-website/shared` パッケージ、または各コンポーネント内に存在すると思われる。
-   APIクライアント (`modules/admin-console/api.ts`) にて、各APIのレスポンスに対応する型（`Reservation`, `TechCatalogEntry`など）が定義されている。

## 5. 主な処理フロー・ユースケース

### 5.1. 初期表示フロー

1.  ユーザーがサイトにアクセス。
2.  Reactアプリケーションがロードされ、`react-router-dom`がURLに応じたページコンポーネントを描画。
3.  `HomePage`では、バックエンドのヘルスチェックAPI (`fetchHealthStatus`) を呼び出し、APIサーバーの状態を表示する可能性がある。
4.  各ページは必要に応じて対応するAPIを呼び出し、コンテンツを取得して表示する。

### 5.2. 管理者によるコンテンツ更新フロー

1.  管理者が `/admin` にアクセス。
2.  `useAdminSession` フックがセッションの有無を確認。なければログインページへリダイレクト（またはログインUIを表示）。
3.  ログイン後、管理ダッシュボードが表示される。
4.  各管理パネル（例: `TechCatalogPanel`）は、対応するAPI（例: `fetchTechCatalog`）を呼び出して現在のデータを表示。
5.  管理者がフォーム入力やD&D操作でデータを変更し、「保存」ボタンをクリック。
6.  対応する更新API（例: `replaceTechCatalog`）が呼び出され、バックエンドにデータが送信される。
7.  成功レスポンスを受け取ると、UIを更新して変更を反映する。

## 6. 非機能要件

### 6.1. UI/UX

-   `tailwindcss`によるユーティリティファーストなスタイリング。
-   `@dnd-kit`による直感的な並べ替え操作。

### 6.2. コード品質・保守性

-   pnpmモノレポ構成による関心の分離（`apps/public` と `packages/shared`）。
-   TypeScriptの全面的な採用による型安全性。
-   Atomic Designに基づいたコンポーネント設計（`atoms`, `molecules`等）。
-   ESLint, Prettierによる静的解析とコードフォーマットの強制。

### 6.3. テスト

-   `vitest`による単体・結合テスト。
-   `@testing-library`によるコンポーネントテスト。
-   `msw` (Mock Service Worker) を利用し、APIをモックしたテストが行われている。これにより、バックエンドに依存しないフロントエンド単体でのテストが可能となっている。

## 7. 現行コードに基づく課題と改善ポイント

### 7.1. 共有パッケージの依存関係

-   `@personal-website/shared` パッケージに、UIコンポーネント、型定義、ユーティリティ関数などが混在している可能性がある。パッケージの責務をより明確にし、必要であれば複数のパッケージに分割することが望ましい。

### 7.2. 状態管理ライブラリの不在

-   `package.json` を見る限り、Redux, Zustand, Recoilといった主要な状態管理ライブラリは導入されていない。現状はReact標準の`useState`, `useContext`やカスタムフックで管理していると推測されるが、アプリケーションがより複雑化した場合に状態管理が煩雑になる可能性がある。

### 7.3. APIクライアントの実装

-   `modules/admin-console/api.ts` にAPI呼び出し関数が集中しているが、より汎用的なAPIクライアント（axiosインスタンスや型生成を伴うクライアントなど）を導入することで、コードの重複を削減し、型安全性をさらに向上させられる可能性がある。

### 7.4. ビルド・デプロイ設定の複雑性

-   `vite.config.ts` や `tsconfig.json` が複数存在し、モノレポ構成に起因する設定の複雑さが見受けられる。設定ファイルの内容を精査し、不要な記述の削除や共通化を進めることで、メンテナンス性が向上する。
